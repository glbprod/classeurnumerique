<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technologie - Cha√Ænes d'√ânergie et d'Information</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <link rel="stylesheet" href="style-form.css">
</head>
<body>
    <div class="container">
        <h1>üîã Cha√Ænes d'√ânergie et d'Information</h1>
        
        <div class="info-box">
            <strong>üìå Consigne :</strong> Dans cet exercice, tu vas compl√©ter 3 cha√Ænes diff√©rentes : 
            une cha√Æne d'√©nergie pour le s√®che-cheveux, une pour la trottinette √©lectrique, et une cha√Æne d'information pour une alarme de piscine.
        </div>

        <form id="dnbForm">
            <!-- IDENTIT√â DE L'√âL√àVE -->
            <h2>üë§ Identification</h2>
            <div class="question">
                <label for="studentName"><strong>Nom et Pr√©nom :</strong></label>
                <input type="text" id="studentName" name="studentName" required 
                       placeholder="">
                
                <label for="studentClass" style="margin-top: 15px; display: block;"><strong>Classe :</strong></label>
                <input type="text" id="studentClass" name="studentClass" required 
                       placeholder="">
            </div>

            <!-- EXERCICE 5 : CHA√éNE D'√âNERGIE S√àCHE-CHEVEUX -->
            <h2>üîå Exercice 1 : La cha√Æne d'√©nergie du s√®che-cheveux</h2>
            
            <div class="info-box">
                <strong>üí° Rappel :</strong> Une cha√Æne d'√©nergie d√©crit le parcours de l'√©nergie dans un objet technique, 
                depuis sa source jusqu'√† son utilisation finale. Elle comporte 4 fonctions : Alimenter, Distribuer, Convertir, Transmettre.
            </div>

            <div class="question">
                <p><strong>Consigne :</strong> Compl√®te le sch√©ma de la cha√Æne d'√©nergie en √©crivant la nature des √©nergies 
                qui circulent entre les blocs fonctionnels. <span class="points">(4 points)</span></p>
                
                <div style="background-color: #e8f4f8; padding: 20px; border-radius: 8px; margin: 15px 0;">
                    <table style="width: 100%; text-align: center;">
                        <tr>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    ALIMENTER<br>
                                    <span style="font-size: 13px; font-weight: normal;">Prise √©lectrique</span>
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    DISTRIBUER<br>
                                    <span style="font-size: 13px; font-weight: normal;">Bouton marche/arr√™t</span>
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    CONVERTIR<br>
                                    <span style="font-size: 13px; font-weight: normal;">R√©sistance chauffante + ventilateur + moteur</span>
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    TRANSMETTRE<br>
                                    <span style="font-size: 13px; font-weight: normal;">Embout sifflet</span>
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #e74c3c; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    Souffler de l'air chaud
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="border: none;"></td>
                            <td style="border: none;"></td>
                            <td colspan="7" style="border: none; padding-top: 15px;">
                                <div style="display: flex; justify-content: space-between; gap: 10px;">
                                    <div style="flex: 1;">
                                        <label style="font-size: 12px; display: block; margin-bottom: 5px;">√ânergie 1 :</label>
                                        <input type="text" name="q5_energie1" required 
                                               placeholder="Nature de l'√©nergie">
                                    </div>
                                    <div style="flex: 1;">
                                        <label style="font-size: 12px; display: block; margin-bottom: 5px;">√ânergie 2 :</label>
                                        <input type="text" name="q5_energie2" required 
                                               placeholder="Nature de l'√©nergie">
                                    </div>
                                    <div style="flex: 1;">
                                        <label style="font-size: 12px; display: block; margin-bottom: 5px;">√ânergie 3 :</label>
                                        <input type="text" name="q5_energie3" required 
                                               placeholder="Nature de l'√©nergie">
                                    </div>
                                    <div style="flex: 1;">
                                        <label style="font-size: 12px; display: block; margin-bottom: 5px;">√ânergie 4 :</label>
                                        <input type="text" name="q5_energie4" required 
                                               placeholder="Nature de l'√©nergie">
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- EXERCICE 6 : CHA√éNE D'√âNERGIE TROTTINETTE -->
            <h2>üõ¥ Exercice 2 : La cha√Æne d'√©nergie de la trottinette √©lectrique</h2>
            
            <div class="info-box">
                <strong>üìñ Contexte :</strong> La trottinette √©lectrique permet √† un utilisateur de se d√©placer sur la route. 
                Lorsque la batterie est charg√©e, l'utilisateur se positionne et allume le syst√®me gr√¢ce au bouton marche/arr√™t. 
                Ensuite, il contr√¥le sa vitesse avec l'acc√©l√©rateur reli√© au moteur par des c√¢bles. 
                Une fois sous tension, le moteur √©lectrique va faire tourner un syst√®me poulies/courroie, 
                qui fait √† son tour tourner la roue arri√®re de l'objet.
            </div>

            <div class="question">
                <p><strong>Consigne :</strong> Compl√®te la cha√Æne d'√©nergie de la trottinette √©lectrique en indiquant 
                les √©l√©ments techniques et la nature des √©nergies. <span class="points">(8 points)</span></p>
                
                <div style="background-color: #e8f4f8; padding: 20px; border-radius: 8px; margin: 15px 0;">
                    <table style="width: 100%; text-align: center;">
                        <tr>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    ALIMENTER
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    DISTRIBUER
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    CONVERTIR
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #5dade2; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    TRANSMETTRE
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #e74c3c; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    Se d√©placer
                                </div>
                            </td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 20px;">
                        <h4 style="text-align: left;">Compl√©ter avec les √©l√©ments techniques :</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>ALIMENTER - √âl√©ment :</strong></label>
                                <input type="text" name="q6_alimenter" required 
                                       placeholder="">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>DISTRIBUER - √âl√©ment :</strong></label>
                                <input type="text" name="q6_distribuer" required 
                                       placeholder="">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>CONVERTIR - √âl√©ment :</strong></label>
                                <input type="text" name="q6_convertir" required 
                                       placeholder="">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>TRANSMETTRE - √âl√©ment :</strong></label>
                                <input type="text" name="q6_transmettre" required 
                                       placeholder="">
                            </div>
                        </div>
                        
                        <h4 style="text-align: left; margin-top: 25px;">Compl√©ter avec la nature des √©nergies :</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>√ânergie √©lectrique :</strong></label>
                                <input type="text" name="q6_energie_electrique" required 
                                       placeholder="O√π appara√Æt-elle ? (ex: entre Alimenter et Distribuer)">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>√ânergie √©lectrique :</strong></label>
                                <input type="text" name="q6_energie_electrique2" required 
                                       placeholder="O√π appara√Æt-elle encore ?">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>√ânergie cin√©tique :</strong></label>
                                <input type="text" name="q6_energie_cinetique1" required 
                                       placeholder="O√π appara√Æt-elle ?">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>√ânergie cin√©tique :</strong></label>
                                <input type="text" name="q6_energie_cinetique2" required 
                                       placeholder="O√π appara√Æt-elle encore ?">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EXERCICE 7 : CHA√éNE D'INFORMATION ALARME PISCINE -->
            <h2>üö® Exercice 3 : La cha√Æne d'information d'une alarme de piscine</h2>
            
            <div class="info-box">
                <strong>üí° Rappel :</strong> Une cha√Æne d'information d√©crit le traitement de l'information dans un syst√®me automatis√©.
                En Technologie, le pupitre est l'interface entre l'humain et la machine.
            </div>
            <div class="question">
                <p><strong>Question :</strong> Pierre a un enfant de 3 ans et souhaite installer une alarme pour sa piscine. 
                Il choisit une alarme munie d'un capteur d'ondes plac√©e sous le niveau d'eau qui d√©tecte les ondulations de l'eau.</p>
                
                <p style="margin-top: 15px;">En cas d'immersion ou de chute dans la piscine, la carte programmable traite l'information 
                re√ßue par le capteur d'ondes et la communique √† la centrale install√©e dans sa maison gr√¢ce √† un √©metteur radio.</p>
                
                <p style="margin-top: 15px;"><strong>Compl√®te la cha√Æne d'information de l'alarme de piscine.</strong> 
                <span class="points">(6 points)</span></p>
                
                <div style="background-color: #f4a460; padding: 20px; border-radius: 8px; margin: 15px 0;">
                    <table style="width: 100%; text-align: center;">
                        <tr>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #d2691e; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    ACQU√âRIR
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #d2691e; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    TRAITER
                                </div>
                            </td>
                            <td style="border: none; padding: 5px;">‚Üí</td>
                            <td style="border: none; padding: 10px;">
                                <div style="background-color: #d2691e; color: white; padding: 15px; border-radius: 5px; font-weight: bold;">
                                    COMMUNIQUER
                                </div>
                            </td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>ACQU√âRIR - √âl√©ment 1 :</strong></label>
                                <input type="text" name="q7_2_acquerir1" required 
                                       placeholder="Premier √©l√©ment">
                                <label style="display: block; margin-top: 10px; margin-bottom: 5px;"><strong>ACQU√âRIR - √âl√©ment 2 :</strong></label>
                                <input type="text" name="q7_2_acquerir2" required 
                                       placeholder="Deuxi√®me √©l√©ment">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>TRAITER - √âl√©ment 1 :</strong></label>
                                <input type="text" name="q7_2_traiter1" required 
                                       placeholder="Premier √©l√©ment">
                                <label style="display: block; margin-top: 10px; margin-bottom: 5px;"><strong>TRAITER - √âl√©ment 2 :</strong></label>
                                <input type="text" name="q7_2_traiter2" required 
                                       placeholder="Deuxi√®me √©l√©ment">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;"><strong>COMMUNIQUER - √âl√©ment 1 :</strong></label>
                                <input type="text" name="q7_2_communiquer1" required 
                                       placeholder="Premier √©l√©ment">
                                <label style="display: block; margin-top: 10px; margin-bottom: 5px;"><strong>COMMUNIQUER - √âl√©ment 2 :</strong></label>
                                <input type="text" name="q7_2_communiquer2" required 
                                       placeholder="Deuxi√®me √©l√©ment">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOUTONS D'ACTION -->
            <div style="display: flex; gap: 15px; margin-top: 30px;">
                <button type="button" id="sendToFirebase" class="submit-btn" style="background-color: #27ae60; flex: 1;">
                    üì§ Envoyer mes r√©ponses
                </button>
                <button type="reset" class="submit-btn" style="background-color: #e74c3c; flex: 0.3;">
                    üîÑ R√©initialiser
                </button>
            </div>
        </form>

        <div id="result" style="margin-top: 20px; padding: 15px; display: none; background-color: #d4edda; border: 2px solid #28a745; border-radius: 5px;">
            <h3>‚úÖ R√©ponses enregistr√©es !</h3>
            <p>Tes r√©ponses ont √©t√© sauvegard√©es avec succ√®s. Tu peux maintenant les relire ou demander une correction √† ton professeur.</p>
        </div>
    </div>

    <script>        
        // ============================================
        // CONFIRMATION AVANT FERMETURE
        // ============================================
        let formModified = false;

        document.getElementById('dnbForm').addEventListener('input', function() {
            formModified = true;
        });

        window.addEventListener('beforeunload', function(e) {
            if (formModified) {
                e.preventDefault();
                e.returnValue = '';
                return '';
            }
        });
           
        // ============================================
        // CONFIGURATION FIREBASE
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyDIvzEk0xKVdRC0r9D_tBGnKPX29Fqkem4",
            authDomain: "form-results-b285b.firebaseapp.com",
            projectId: "form-results-b285b",
            storageBucket: "form-results-b285b.firebasestorage.app",
            messagingSenderId: "662462446647",
            appId: "1:662462446647:web:0fe6315cc0c189185513b2"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        console.log('‚úÖ Firebase initialis√©');

        // ============================================
        // BOUTON D'ENVOI VERS FIREBASE
        // ============================================
        document.getElementById('sendToFirebase').addEventListener('click', async function() {
            const form = document.getElementById('dnbForm');
            
            // V√©rifier la validit√© du formulaire
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // D√©sactiver le bouton
            const originalText = this.textContent;
            this.disabled = true;
            this.textContent = '‚è≥ Envoi en cours...';
            
            try {
                // Collecter les donn√©es
                const formData = new FormData(form);
                
                const responses = {
                    // Identification
                    nom_eleve: formData.get('studentName'),
                    classe: formData.get('studentClass'),
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    date_soumission: new Date().toISOString(),
                    
                    // Exercice 5 - Cha√Æne √©nergie s√®che-cheveux
                    q5_energie1: formData.get('q5_energie1'),
                    q5_energie2: formData.get('q5_energie2'),
                    q5_energie3: formData.get('q5_energie3'),
                    q5_energie4: formData.get('q5_energie4'),
                    
                    // Exercice 6 - Cha√Æne √©nergie trottinette
                    q6_alimenter: formData.get('q6_alimenter'),
                    q6_distribuer: formData.get('q6_distribuer'),
                    q6_convertir: formData.get('q6_convertir'),
                    q6_transmettre: formData.get('q6_transmettre'),
                    q6_energie_electrique: formData.get('q6_energie_electrique'),
                    q6_energie_electrique2: formData.get('q6_energie_electrique2'),
                    q6_energie_cinetique1: formData.get('q6_energie_cinetique1'),
                    q6_energie_cinetique2: formData.get('q6_energie_cinetique2'),
                    
                    // Exercice 7.1 - Cha√Æne information th√©orique
                    q7_1_bloc1: formData.get('q7_1_bloc1'),
                    q7_1_bloc2: formData.get('q7_1_bloc2'),
                    q7_1_bloc3: formData.get('q7_1_bloc3'),
                    q7_1_bloc4: formData.get('q7_1_bloc4'),
                    q7_1_bloc5: formData.get('q7_1_bloc5'),
                    
                    // Exercice 7.2 - Cha√Æne information alarme piscine
                    q7_2_acquerir1: formData.get('q7_2_acquerir1'),
                    q7_2_acquerir2: formData.get('q7_2_acquerir2'),
                    q7_2_traiter1: formData.get('q7_2_traiter1'),
                    q7_2_traiter2: formData.get('q7_2_traiter2'),
                    q7_2_communiquer1: formData.get('q7_2_communiquer1'),
                    q7_2_communiquer2: formData.get('q7_2_communiquer2')
                };
                
                console.log('üì§ Envoi des donn√©es:', responses);
                
                // Envoyer √† Firebase dans la collection "chaines_energie_info"
                const docRef = await db.collection('chaines_energie_info').add(responses);
                
                console.log('‚úÖ Document enregistr√© avec ID:', docRef.id);
                
                // R√©activer le bouton
                this.disabled = false;
                this.textContent = originalText;
                
                // Notification de succ√®s
                document.getElementById('result').style.display = 'block';
                document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
                
                // R√©initialiser le formulaire apr√®s 3 secondes
                setTimeout(() => {
                    form.reset();
                    formModified = false;
                    document.getElementById('result').style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('‚ùå Erreur Firebase:', error);
                
                // R√©activer le bouton
                this.disabled = false;
                this.textContent = originalText;
                
                // Notification d'erreur
                alert('‚ùå Erreur lors de l\'envoi : ' + error.message);
            }
        });

        // ============================================
        // GESTION DU BOUTON R√âINITIALISER
        // ============================================
        document.getElementById('dnbForm').addEventListener('reset', function() {
            if (confirm('Es-tu s√ªr de vouloir effacer toutes tes r√©ponses ?')) {
                formModified = false;
                document.getElementById('result').style.display = 'none';
            } else {
                return false;
            }
        });
    </script>
</body>
</html>
