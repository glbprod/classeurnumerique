<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche Activit√© - √ânergies et Objets Techniques</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            background-color: #ecf0f1;
            padding: 10px;
            border-left: 4px solid #3498db;
        }
        h3 {
            color: #2c3e50;
            margin-top: 20px;
        }
        .question {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .points {
            color: #e74c3c;
            font-weight: bold;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 2px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 2px solid #34495e;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #34495e;
            color: white;
        }
        td input[type="text"] {
            border: 1px solid #95a5a6;
        }
        .submit-btn {
            background-color: #27ae60;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            display: block;
            width: 100%;
        }
        .submit-btn:hover {
            background-color: #229954;
        }
        .intro {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
        }
        .info-box {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        .info-box h3 {
            margin-top: 0;
        }
        .competence-box {
            background-color: #d1ecf1;
            padding: 15px;
            border-left: 4px solid #17a2b8;
            margin: 15px 0;
        }
        .image-placeholder {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .image-item {
            text-align: center;
            margin: 10px;
            flex: 1;
            min-width: 200px;
        }
        .image-box {
            width: 150px;
            height: 150px;
            background-color: #ecf0f1;
            border: 2px solid #34495e;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #7f8c8d;
            border-radius: 5px;
        }
        .storage-label {
            display: inline-block;
            padding: 8px 15px;
            background-color: #34495e;
            color: white;
            border-radius: 5px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        ul {
            line-height: 1.8;
        }
        .section-title {
            background-color: #3498db;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° FICHE ACTIVIT√â - √ânergies et Objets Techniques</h1>
        
        <div class="section-title">
            <h3 style="margin: 0; color: white;">S√©quence 2 : Comment les diff√©rentes formes d'√©nergie ont-elles fait √©voluer les objets techniques ?</h3>
            <p style="margin: 5px 0 0 0; color: white;">Activit√© : Quel est le chemin de l'√©nergie dans un objet technique ?</p>
        </div>

        <div class="competence-box">
            <h3>Comp√©tences travaill√©es</h3>
            <p><strong>MMEI 3.1 :</strong> Reconna√Ætre les situations o√π l'√©nergie est stock√©e, transform√©e, utilis√©e. La fabrication et le fonctionnement d'un objet technique n√©cessitent de l'√©nergie.</p>
        </div>

        <div class="intro">
            <h3>Objectifs de l'activit√© :</h3>
            <ul>
                <li>Comprendre la notion de conversion d'√©nergie</li>
                <li>Identifier les √©l√©ments qui composent la cha√Æne d'√©nergie d'un objet technique</li>
            </ul>
            <p style="margin-top: 15px;"><em>L'√©nergie n'est presque jamais utilis√©e telle quelle, √† la sortie de sa production. Bien souvent, elle doit √™tre transform√©e afin d'√™tre utilis√©e. Nos objets techniques demandent l'utilisation d'√©nergies particuli√®re, ce qui explique le besoin de transformer l'√©nergie.</em></p>
        </div>

        <form id="energiesForm">
            <!-- Identification de l'√©l√®ve -->
            <div class="question" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                <p><strong>Nom et Pr√©nom :</strong></p>
                <input type="text" id="studentName" name="studentName" placeholder="" required>
                
                <p style="margin-top: 15px;"><strong>Classe :</strong></p>
                <input type="text" id="studentClass" name="studentClass" placeholder="" required>
            </div>

            <!-- Partie 1: Entr√©e-Sortie -->
            <div class="question">
                <h2>1/- Entr√©e-Sortie</h2>
                <p><strong>Observez ces diff√©rents objets techniques du quotidien et r√©pondez aux questions dans le tableau ci-dessous :</strong></p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Objets techniques</th>
                            <th>Quelle est sa fonction d'usage (√† quoi sert-il) ?</th>
                            <th>Quelle est l'√©nergie d'entr√©e de cet objet ?</th>
                            <th>Quelle est l'√©nergie de sortie de cet objet ?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Bicyclette</strong></td>
                            <td><input type="text" name="bicyclette_fonction" placeholder="Fonction d'usage"></td>
                            <td><input type="text" name="bicyclette_entree" placeholder="√ânergie d'entr√©e"></td>
                            <td><input type="text" name="bicyclette_sortie" placeholder="√ânergie de sortie"></td>
                        </tr>
                        <tr>
                            <td><strong>Lampe de poche</strong></td>
                            <td><input type="text" name="lampe_fonction" placeholder="Fonction d'usage"></td>
                            <td><input type="text" name="lampe_entree" placeholder="√ânergie d'entr√©e"></td>
                            <td><input type="text" name="lampe_sortie" placeholder="√ânergie de sortie"></td>
                        </tr>
                        <tr>
                            <td><strong>Ventilateur</strong></td>
                            <td><input type="text" name="ventilateur_fonction" placeholder="Fonction d'usage"></td>
                            <td><input type="text" name="ventilateur_entree" placeholder="√ânergie d'entr√©e"></td>
                            <td><input type="text" name="ventilateur_sortie" placeholder="√ânergie de sortie"></td>
                        </tr>
                        <tr>
                            <td><strong>Bouilloire √©lectrique</strong></td>
                            <td><input type="text" name="bouilloire_fonction" placeholder="Fonction d'usage"></td>
                            <td><input type="text" name="bouilloire_entree" placeholder="√ânergie d'entr√©e"></td>
                            <td><input type="text" name="bouilloire_sortie" placeholder="√ânergie de sortie"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Partie 2: Conversion et stockage -->
            <div class="question">
                <h2>2/- Conversion et stockage</h2>
                
                <div class="info-box">
                    <p><strong>üìΩÔ∏è Avant de r√©pondre aux questions suivantes, regardez les deux vid√©os disponibles dans les RESSOURCES :</strong></p>
                </div>

                <p><strong>Jouons aux analogies, c'est-√†-dire aux comparaisons. D'un c√¥t√© nous avons le corps humain, d'un autre une voiture √† essence. √Ä vous de remplir correctement le tableau ci-dessous :</strong></p>
                
                <table>
                    <thead>
                        <tr>
                            <th>Quelle est ....</th>
                            <th>Dans le corps humain</th>
                            <th>Dans une voiture √† essence</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>... l'√©nergie d'entr√©e</strong></td>
                            <td><input type="text" name="humain_energie_entree" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_energie_entree" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... l'√©nergie de sortie</strong></td>
                            <td><input type="text" name="humain_energie_sortie" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_energie_sortie" placeholder="R√©ponse"></td>
                        </tr>
                    </tbody>
                </table>

                <h3 style="margin-top: 30px;">Qu'est ce qui sert √† ...</h3>
                
                <table>
                    <thead>
                        <tr>
                            <th>Fonction</th>
                            <th>Dans le corps humain</th>
                            <th>Dans une voiture √† essence</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>... se d√©placer</strong></td>
                            <td><input type="text" name="humain_deplacer" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_deplacer" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... se guider</strong></td>
                            <td><input type="text" name="humain_guider" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_guider" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... stocker l'√©nergie d'entr√©e</strong></td>
                            <td><input type="text" name="humain_stocker" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_stocker" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... distribuer cette √©nergie</strong></td>
                            <td><input type="text" name="humain_distribuer" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_distribuer" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... convertir (transformer) cette √©nergie en mouvement</strong></td>
                            <td><input type="text" name="humain_convertir" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_convertir" placeholder="R√©ponse"></td>
                        </tr>
                        <tr>
                            <td><strong>... transmettre ce mouvement pour avancer</strong></td>
                            <td><input type="text" name="humain_transmettre" placeholder="R√©ponse"></td>
                            <td><input type="text" name="voiture_transmettre" placeholder="R√©ponse"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Partie 3: Stockage d'√©nergie -->
            <div class="question">
                <h2>Quoi faire de l'√©nergie non utilis√©e ?</h2>
                
                <div class="info-box">
                    <p><em>¬´ Lorsque l'on utilise pas toute l'√©nergie disponible, on peut dans certains cas la stocker sous diff√©rentes formes. Cette √©nergie pourras √™tre d√©stock√©e pour satisfaire des besoins ult√©rieurs. ¬ª</em></p>
                </div>

                <p><strong>En compl√©ment de ce texte, associez les lettres des m√©thodes de stockage de l'√©nergie propos√©es ci-dessous aux images correspondantes :</strong></p>

                <div style="margin: 20px 0;">
                    <p><strong>M√©thodes de stockage disponibles :</strong></p>
                    <ul>
                        <li><strong>A</strong> - Stockage d'eau</li>
                        <li><strong>B</strong> - Batterie chimique</li>
                        <li><strong>C</strong> - R√©serve de graisses</li>
                        <li><strong>D</strong> - Stockage de gaz combustible</li>
                    </ul>
                </div>

                <div class="image-placeholder">
                    <div class="image-item">
                        <div class="image-box">[Image 1: Barrage hydraulique]</div>
                        <p><strong>Image 1 - Lettre :</strong></p>
                        <input type="text" name="stockage_image1" placeholder="A, B, C ou D" style="width: 100px; text-align: center;">
                    </div>
                    
                    <div class="image-item">
                        <div class="image-box">[Image 2: Animal (marmotte)]</div>
                        <p><strong>Image 2 - Lettre :</strong></p>
                        <input type="text" name="stockage_image2" placeholder="A, B, C ou D" style="width: 100px; text-align: center;">
                    </div>
                    
                    <div class="image-item">
                        <div class="image-box">[Image 3: Coffre de voiture avec bonbonnes]</div>
                        <p><strong>Image 3 - Lettre :</strong></p>
                        <input type="text" name="stockage_image3" placeholder="A, B, C ou D" style="width: 100px; text-align: center;">
                    </div>
                    
                    <div class="image-item">
                        <div class="image-box">[Image 4: Barrage/r√©servoir]</div>
                        <p><strong>Image 4 - Lettre :</strong></p>
                        <input type="text" name="stockage_image4" placeholder="A, B, C ou D" style="width: 100px; text-align: center;">
                    </div>
                </div>
            </div>

            <!-- Partie 4: La cha√Æne d'√©nergie -->
            <div class="question">
                <h2>3/- La cha√Æne d'√©nergie</h2>
                
                <p><strong>√Ä pr√©sent, compl√©tez les phrases ci-dessous en vous aidant de tout ce que vous avez fait pr√©c√©demment :</strong></p>
                
                <div style="background-color: white; padding: 20px; border: 2px solid #34495e; border-radius: 5px; line-height: 2;">
                    <p>Dans tout objet technique, on distingue une √©nergie 
                        <input type="text" name="phrase_energie1" placeholder="..." style="width: 150px; display: inline-block;"> 
                        et une √©nergie 
                        <input type="text" name="phrase_energie2" placeholder="..." style="width: 150px; display: inline-block;">. 
                    </p>
                    
                    <p>L'√©nergie 
                        <input type="text" name="phrase_energie3" placeholder="..." style="width: 150px; display: inline-block;"> 
                        permet la mise en fonctionnement de l'objet ; l'√©nergie 
                        <input type="text" name="phrase_energie4" placeholder="..." style="width: 150px; display: inline-block;"> 
                        est directement li√©e √† l'action attendue (√©clairer, se d√©placer ‚Ä¶).
                    </p>
                    
                    <p>Lorsque ces deux √©nergies sont diff√©rentes, cela signifie qu'un ou des composants de l'objet technique 
                        <input type="text" name="phrase_action" placeholder="..." style="width: 150px; display: inline-block;"> 
                        l'√©nergie 
                        <input type="text" name="phrase_energie5" placeholder="..." style="width: 150px; display: inline-block;"> 
                        en √©nergie 
                        <input type="text" name="phrase_energie6" placeholder="..." style="width: 150px; display: inline-block;">.
                    </p>
                    
                    <p>Avant cela, d'autres composants de l'objet technique permettent de 
                        <input type="text" name="phrase_stocker" placeholder="..." style="width: 150px; display: inline-block;"> 
                        cette √©nergie pour pouvoir l'utiliser plus tard.
                    </p>
                </div>

                <div class="info-box" style="margin-top: 20px;">
                    <p><strong>üí° Rappel :</strong></p>
                    <p>Il est alors possible, une fois que l'on a identifi√© tous les composants de l'objet technique, de cr√©er un sch√©ma du circuit de l'√©nergie dans l'objet technique => <strong>¬´ la cha√Æne d'√©nergie ¬ª</strong>.</p>
                    <p>Ce sch√©ma permet de mettre en √©vidence les fonctions des composants.</p>
                </div>
            </div>

            <div style="display: flex; gap: 15px; margin-top: 20px;">
                <button type="button" id="sendToFirebase" class="submit-btn" style="background-color: #27ae60; flex: 1;">
                    üì§ Envoyer mes r√©ponses
                </button>
                <button type="reset" class="submit-btn" style="background-color: #e74c3c; flex: 0.3;">
                    üîÑ R√©initialiser
                </button>
            </div>
        </form>

        <div id="result" style="margin-top: 20px; padding: 15px; display: none; background-color: #d4edda; border: 2px solid #28a745; border-radius: 5px;">
            <h3>‚úÖ R√©ponses enregistr√©es !</h3>
            <p>Vos r√©ponses ont √©t√© sauvegard√©es. Vous pouvez maintenant les relire ou demander une correction √† votre professeur.</p>
        </div>
    </div>

    <script>
        // Protection par mot de passe
        function() {
            const MOT_DE_PASSE = 'techno'; // ‚Üê Changez ici
            let tentatives = 5;
            
            while (tentatives > 0) {
                const saisie = prompt('üîí Mot de passe requis pour acc√©der au formulaire :');
                
                if (saisie === null) {
                    document.body.innerHTML = '<h1 style="text-align:center;margin-top:50px;">‚ùå Acc√®s annul√©</h1>';
                    throw new Error('Acc√®s annul√©');
                }
                
                if (saisie === MOT_DE_PASSE) {
                    return; // ‚úÖ Mot de passe correct
                }
                
                tentatives--;
                if (tentatives > 0) {
                    alert('‚ùå Mot de passe incorrect ! Il vous reste ' + tentatives + ' tentative(s).');
                }
            }
            
            alert('üö´ Nombre de tentatives d√©pass√© !');
            document.body.innerHTML = '<h1 style="text-align:center;margin-top:50px;">‚ùå Acc√®s refus√©</h1>';
            throw new Error('Acc√®s refus√©');
        })();
        
        // ============================================
        // CONFIRMATION AVANT FERMETURE
        // ============================================
        let formModified = false;

        document.getElementById('energiesForm').addEventListener('input', function() {
            formModified = true;
        });

        window.addEventListener('beforeunload', function(e) {
            if (formModified) {
                e.preventDefault();
                e.returnValue = '';
                return '';
            }
        });
           
        // ============================================
        // CONFIGURATION FIREBASE
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyDIvzEk0xKVdRC0r9D_tBGnKPX29Fqkem4",
            authDomain: "form-results-b285b.firebaseapp.com",
            projectId: "form-results-b285b",
            storageBucket: "form-results-b285b.firebasestorage.app",
            messagingSenderId: "662462446647",
            appId: "1:662462446647:web:0fe6315cc0c189185513b2"
        };

        // Initialiser Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        console.log('‚úÖ Firebase initialis√©');

        // ============================================
        // BOUTON D'ENVOI
        // ============================================
        document.getElementById('sendToFirebase').addEventListener('click', async function() {
            const form = document.getElementById('energiesForm');
            
            // V√©rifier la validit√© du formulaire
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // D√©sactiver le bouton
            const originalText = this.textContent;
            this.disabled = true;
            this.textContent = '‚è≥ Envoi en cours...';
            
            try {
                // Collecter les donn√©es
                const formData = new FormData(form);
                
                const responses = {
                    nom_eleve: document.getElementById('studentName').value,
                    classe: document.getElementById('studentClass').value,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    date_soumission: new Date().toISOString(),
                    
                    // Partie 1: Entr√©e-Sortie
                    bicyclette_fonction: formData.get('bicyclette_fonction') || '',
                    bicyclette_entree: formData.get('bicyclette_entree') || '',
                    bicyclette_sortie: formData.get('bicyclette_sortie') || '',
                    lampe_fonction: formData.get('lampe_fonction') || '',
                    lampe_entree: formData.get('lampe_entree') || '',
                    lampe_sortie: formData.get('lampe_sortie') || '',
                    ventilateur_fonction: formData.get('ventilateur_fonction') || '',
                    ventilateur_entree: formData.get('ventilateur_entree') || '',
                    ventilateur_sortie: formData.get('ventilateur_sortie') || '',
                    bouilloire_fonction: formData.get('bouilloire_fonction') || '',
                    bouilloire_entree: formData.get('bouilloire_entree') || '',
                    bouilloire_sortie: formData.get('bouilloire_sortie') || '',
                    
                    // Partie 2: Conversion et stockage
                    humain_energie_entree: formData.get('humain_energie_entree') || '',
                    humain_energie_sortie: formData.get('humain_energie_sortie') || '',
                    voiture_energie_entree: formData.get('voiture_energie_entree') || '',
                    voiture_energie_sortie: formData.get('voiture_energie_sortie') || '',
                    humain_deplacer: formData.get('humain_deplacer') || '',
                    voiture_deplacer: formData.get('voiture_deplacer') || '',
                    humain_guider: formData.get('humain_guider') || '',
                    voiture_guider: formData.get('voiture_guider') || '',
                    humain_stocker: formData.get('humain_stocker') || '',
                    voiture_stocker: formData.get('voiture_stocker') || '',
                    humain_distribuer: formData.get('humain_distribuer') || '',
                    voiture_distribuer: formData.get('voiture_distribuer') || '',
                    humain_convertir: formData.get('humain_convertir') || '',
                    voiture_convertir: formData.get('voiture_convertir') || '',
                    humain_transmettre: formData.get('humain_transmettre') || '',
                    voiture_transmettre: formData.get('voiture_transmettre') || '',
                    
                    // Partie 3: Stockage d'√©nergie
                    stockage_image1: formData.get('stockage_image1') || '',
                    stockage_image2: formData.get('stockage_image2') || '',
                    stockage_image3: formData.get('stockage_image3') || '',
                    stockage_image4: formData.get('stockage_image4') || '',
                    
                    // Partie 4: La cha√Æne d'√©nergie
                    phrase_energie1: formData.get('phrase_energie1') || '',
                    phrase_energie2: formData.get('phrase_energie2') || '',
                    phrase_energie3: formData.get('phrase_energie3') || '',
                    phrase_energie4: formData.get('phrase_energie4') || '',
                    phrase_action: formData.get('phrase_action') || '',
                    phrase_energie5: formData.get('phrase_energie5') || '',
                    phrase_energie6: formData.get('phrase_energie6') || '',
                    phrase_stocker: formData.get('phrase_stocker') || ''
                };
                
                console.log('üì§ Envoi des donn√©es:', responses);
                
                // Envoyer √† Firebase
                const docRef = await db.collection('fiche_activite_energies').add(responses);
                
                console.log('‚úÖ Document enregistr√© avec ID:', docRef.id);
                
                // R√©activer le bouton
                this.disabled = false;
                this.textContent = originalText;
                
                // Notification de succ√®s
                document.getElementById('result').style.display = 'block';
                document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
                
                // R√©initialiser le formulaire apr√®s 3 secondes
                setTimeout(() => {
                    form.reset();
                    formModified = false;
                    document.getElementById('result').style.display = 'none';
                }, 3000);
                
            } catch (error) {
                console.error('‚ùå Erreur Firebase:', error);
                
                // R√©activer le bouton
                this.disabled = false;
                this.textContent = originalText;
                
                // Notification d'erreur
                alert('‚ùå Erreur lors de l\'envoi : ' + error.message);
            }
        });

        // Gestion du bouton de r√©initialisation
        document.getElementById('energiesForm').addEventListener('reset', function() {
            if (confirm('√ätes-vous s√ªr de vouloir effacer toutes vos r√©ponses ?')) {
                formModified = false;
                document.getElementById('result').style.display = 'none';
            } else {
                return false;
            }
        });
    </script>
</body>
</html>
